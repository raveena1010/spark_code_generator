Stockcompanies = spark.read.option('header',True).option('delimiter',',').option('inferSchema',True).csv('loc')
Stockcompanies = spark.read.option('header',True).option('delimiter',',').option('inferSchema',True).csv('loc')
stock_price_less_memoryused = spark.read.option('header',True).option('delimiter',',').option('inferSchema',True).csv('loc')
stock_price_less_memoryused_alias = stock_price_less_memoryused.toDF(*['xString', 'xvarchar', 'xstring'])
Stockcompanies_alias = Stockcompanies.toDF(*['yTicker_symbol', 'ySecurity', 'ySector', 'ySub_Industry', 'yHeadquarter'])
stock_price_less_memoryused_Stockcompanies_join = stock_price_less_memoryused.join(Stockcompanies,[stock_price_less_memoryused_alias.xTicker_symbol==Stockcompanies_alias.ysymbol,stock_price_less_memoryused_alias.xvarchar==Stockcompanies_alias.ySecurity],'{'left outer': {}}')
stock_price_less_memoryused_Stockcompanies_join = stock_price_less_memoryused_Stockcompanies_join.select(['xSecurity', 'xTicker_symbol', 'ydate'])
Stockcompanies_stock_price_less_memoryused_Stockcompanies_join_join = Stockcompanies.join(stock_price_less_memoryused_Stockcompanies_join,[Stockcompanies.xTicker_symbol==stock_price_less_memoryused_Stockcompanies_join.Ticker_symbol],'inner')
